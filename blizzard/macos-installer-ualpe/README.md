# Battle.net installer for macOS UALPE
This code demonstrates how a user-assisted local privilege escalation
vulnerability in Blizzard's Battle.net installer for macOS could be exploited.

## Threat model
An attacker must have code execution on the victim's computer to exploit
this vulnerability. The goal of the attacker is to elevate their privileges
from a standard macOS user to 'root'. The attacker abuses the authentication
dialog created by the Blizzard macOS installer, and the user's willingness to
trust Blizzard software (presumably, the user might believe this is part of
an update process).

This niche class of bugs are known as "User-assisted local privilege
escalation". Refer to Patrick Wardle's "Death by 1000 Installers; itâ€™s All
Broken!" presentation for more information on the topic.

## Affects
Battle.net installer for macOS - 1.16.3.2988

## Usage
1. Compile the exploit with `GOOS=darwin go build main.go`
2. Copy the exploit onto the test machine
3. Run the exploit from a shell
4. Run the Battle.net installer, making sure to enter your credentials at the
macOS dialog box
5. Exploit complete

## References
- [Fox Jr., S.](https://0x2d13.net/posts/2020/09/26/from-strings-to-riches/#references). (2020, September 26). "From strings to riches: Finding a user-assisted LPE in the wild".
- [Wardle, P.](https://speakerdeck.com/patrickwardle/defcon-2017-death-by-1000-installers-its-all-broken). (2017, July 28). "[DefCon 2017] Death by 1000 Installers; it's All Broken!".
